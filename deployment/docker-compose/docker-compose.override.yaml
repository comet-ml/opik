# Docker Compose Override for Port Mapping
# Port variables are set automatically by worktree-utils.sh for multi-worktree isolation

services:
  mysql:
    ports:
      - "${MYSQL_PORT:-3306}:3306"

  redis:
    ports:
      - "${REDIS_PORT:-6379}:6379"

  clickhouse:
    ports:
      - "${CLICKHOUSE_HTTP_PORT:-8123}:8123"
      - "${CLICKHOUSE_NATIVE_PORT:-9000}:9000"

  zookeeper:
    ports:
      - "${ZOOKEEPER_PORT:-2181}:2181"

  minio:
    ports:
      - "${MINIO_API_PORT:-9001}:9000"
      - "${MINIO_CONSOLE_PORT:-9090}:9090"

  backend:
    ports: !override
      - "${OPIK_BACKEND_PORT:-8080}:8080"
      - "3003:3003"

  python-backend:
    environment:
      OPIK_URL_OVERRIDE: ${OPIK_URL_OVERRIDE:-http://host.docker.internal:${OPIK_BACKEND_PORT:-8080}}
    ports:
      - "${PYTHON_BACKEND_PORT:-8000}:${PYTHON_BACKEND_PORT:-8000}"

  opik-ai-backend:
    ports:
      - "${OPIK_AI_BACKEND_PORT:-8081}:8081"
