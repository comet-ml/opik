name: opik

# Override for local backend + frontend development mode
# This mode starts infrastructure + Python backend only
# Java backend and frontend run as local processes

services:

  # Expose infrastructure ports for local backend and frontend to connect
  mysql:
    ports:
      - "3306:3306"

  redis:
    ports:
      - "6379:6379"

  clickhouse:
    ports:
      - "8123:8123" # ClickHouse HTTP port
      - "9000:9000" # ClickHouse Native Protocol port

  minio:
    ports:
      - "9001:9000"   # MinIO API Port
      - "9090:9090"   # MinIO Web UI Console

  # Python backend runs in Docker with local-be-fe profile
  python-backend:
    profiles: !override
      - backend
      - opik
      - local-be-fe
    ports:
      - "8000:8000" # Python backend HTTP port

  # Disable the Java backend service entirely
  backend:
    profiles: !override
      - disabled

  # Disable frontend service (runs as local process)
  frontend:
    profiles: !override
      - disabled

  # Enable demo-data-generator for local-be-fe profile
  demo-data-generator:
    profiles: !override
      - opik
      - local-be-fe

